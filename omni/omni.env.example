# ==============================================================================
# OMNI SELF-HOSTED CONFIGURATION
# ==============================================================================
# Copy this file to omni.env and fill in your actual values
# DO NOT commit omni.env to version control - it contains secrets!

# ==============================================================================
# REQUIRED: Omni Configuration
# ==============================================================================

# Generate with: uuidgen
OMNI_ACCOUNT_UUID=00000000-0000-0000-0000-000000000000

# Deployment name (can be any descriptive name)
NAME=omni-prod

# Omni Docker image version
# Check https://github.com/siderolabs/omni/releases for latest
# v1.4.0 (Dec 2025): SQLite storage consolidation, OIDC improvements, machine class updates
OMNI_IMG_TAG=v1.4.0

# ==============================================================================
# REQUIRED: Domain and Network Configuration
# ==============================================================================

# Your Omni domain name (local-only setup uses omni.vanillax.me)
# Configure in Firewalla DNS to resolve to 192.168.10.15
OMNI_DOMAIN_NAME=omni.vanillax.me

# Bind addresses for various services
BIND_ADDR=0.0.0.0:443
MACHINE_API_BIND_ADDR=0.0.0.0:8090
K8S_PROXY_BIND_ADDR=0.0.0.0:8100
EVENT_SINK_PORT=8091

# Advertised URLs (local network only, resolved via Firewalla DNS)
ADVERTISED_API_URL=https://omni.vanillax.me
ADVERTISED_K8S_PROXY_URL=https://omni.vanillax.me:8100/
SIDEROLINK_ADVERTISED_API_URL=https://omni.vanillax.me:8090/

# WireGuard address - Omni host's private IP on local network
SIDEROLINK_WIREGUARD_ADVERTISED_ADDR=192.168.10.15:50180

# ==============================================================================
# REQUIRED: SSL/TLS Certificates
# ==============================================================================

# Path to SSL certificate and key
# Get cert for omni.vanillax.me via Let's Encrypt DNS challenge:
# sudo certbot certonly --dns-cloudflare -d omni.vanillax.me
TLS_CERT=/etc/letsencrypt/live/omni.vanillax.me/fullchain.pem
TLS_KEY=/etc/letsencrypt/live/omni.vanillax.me/privkey.pem

# ==============================================================================
# REQUIRED: Etcd Data Encryption
# ==============================================================================

# Path to etcd data directory on host
ETCD_VOLUME_PATH=/etc/etcd

# Path to SQLite storage directory on host (NEW in v1.4.0 - REQUIRED)
# This consolidates Discovery service state, Audit logs, Machine logs, and Secondary resources
SQLITE_STORAGE_PATH=/etc/omni/sqlite/

# Path to GPG key file (exported with: gpg --export-secret-key --armor)
ETCD_ENCRYPTION_KEY=/path/to/omni.asc

# ==============================================================================
# REQUIRED: Initial Admin User
# ==============================================================================

# Email address of the initial admin user
# This email must match an account in your authentication provider
INITIAL_USER_EMAILS=admin@example.com

# ==============================================================================
# REQUIRED: Authentication Configuration
# ==============================================================================
# Choose ONE authentication method below and uncomment the appropriate AUTH line

# -----------------------------------------------------------------------------
# Option A: Auth0
# -----------------------------------------------------------------------------
# 1. Create account at https://auth0.com
# 2. Create a Single Page Application
# 3. Configure callback URLs:
#    - Allowed Callback URLs: https://omni.vanillax.me:443/oidc/callback
#    - Allowed Logout URLs: https://omni.vanillax.me:443/
#    - Allowed Web Origins: https://omni.vanillax.me:443
# 4. Copy Domain and Client ID below

AUTH=--auth-auth0-enabled=true --auth-auth0-domain=YOUR_AUTH0_DOMAIN.us.auth0.com --auth-auth0-client-id=YOUR_AUTH0_CLIENT_ID

# -----------------------------------------------------------------------------
# Option B: SAML
# -----------------------------------------------------------------------------
# Uncomment and configure for your SAML provider

# AUTH=--auth-saml-enabled=true --auth-saml-url=https://your-saml-provider.com/sso/saml

# -----------------------------------------------------------------------------
# Option C: OIDC (OpenID Connect)
# -----------------------------------------------------------------------------
# Uncomment and configure for your OIDC provider

# AUTH=--auth-oidc-enabled=true --auth-oidc-issuer=https://your-oidc-provider.com --auth-oidc-client-id=YOUR_OIDC_CLIENT_ID

# ==============================================================================
# OPTIONAL: Additional Configuration
# ==============================================================================

# Uncomment to enable debug logging
# Add to command: --log-level=debug
