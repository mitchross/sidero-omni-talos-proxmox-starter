# Omni Environment Configuration
# Copy this file to omni.env and fill in your values
# Run: cp .env.example omni.env

# =============================================================================
# Omni Version
# =============================================================================
# Using v1.3.0-beta.2 or later for latest features
# Stable version: v1.2.1
# Beta version: v1.3.0-beta.2 (includes cluster import, kernel args support)
OMNI_IMG_TAG=v1.3.0-beta.2

# =============================================================================
# Account Configuration
# =============================================================================
# Generate a unique UUID with: uuidgen
OMNI_ACCOUNT_UUID=a0fa88a3-638f-43b3-85e1-7bd8c17a1d8c

# Display name for your Omni instance
NAME=omni

# Event sink port for internal communication
EVENT_SINK_PORT=8091

# =============================================================================
# SSL/TLS Certificates
# =============================================================================
# Path to SSL certificate (fullchain)
TLS_CERT=/etc/letsencrypt/live/omni.example.com/fullchain.pem

# Path to SSL private key
TLS_KEY=/etc/letsencrypt/live/omni.example.com/privkey.pem

# =============================================================================
# etcd Storage Configuration
# =============================================================================
# IMPORTANT: Use a local directory for easier maintenance
# Avoid using /etc/etcd/ as it requires sudo for cleanup
# Recommended: Use a directory in your home folder or current directory
ETCD_VOLUME_PATH=./etcd

# Path to GPG key for etcd encryption
# Generate with: ./generate-gpg-key.sh
ETCD_ENCRYPTION_KEY=./omni.asc

# =============================================================================
# Network Binding Configuration
# =============================================================================
# Bind addresses for services
# Use 0.0.0.0 to bind to all interfaces
# For security, consider binding to specific IP if not publicly accessible
BIND_ADDR=0.0.0.0:443
MACHINE_API_BIND_ADDR=0.0.0.0:8090
K8S_PROXY_BIND_ADDR=0.0.0.0:8100

# =============================================================================
# Domain and Advertisement URLs
# =============================================================================
# Your domain name
OMNI_DOMAIN_NAME=omni.example.com

# Advertised API URL (HTTPS)
ADVERTISED_API_URL=https://omni.example.com

# SideroLink API advertised URL
SIDEROLINK_ADVERTISED_API_URL=https://omni.example.com:8090/

# Kubernetes proxy advertised URL
ADVERTISED_K8S_PROXY_URL=https://omni.example.com:8100/

# SideroLink WireGuard advertised address
# Format: domain:port
# Default WireGuard port: 50180 (can be customized if needed)
SIDEROLINK_WIREGUARD_ADVERTISED_ADDR=omni.example.com:50180

# =============================================================================
# User Configuration
# =============================================================================
# Initial admin user email(s)
# Separate multiple emails with commas
INITIAL_USER_EMAILS=admin@example.com

# =============================================================================
# Authentication Configuration
# =============================================================================
# Choose ONE authentication method: Auth0 OR SAML

## Auth0 Configuration
AUTH='--auth-auth0-enabled=true \
      --auth-auth0-domain=dev-xxxxxxxx.us.auth0.com \
      --auth-auth0-client-id=your-auth0-client-id'

## SAML Configuration (Alternative to Auth0)
# Uncomment below and comment out Auth0 if using SAML
# AUTH='--auth-saml-enabled=true \
#       --auth-saml-url=https://your-saml-provider.com/saml'

# =============================================================================
# Auth0 Setup Instructions
# =============================================================================
# 1. Create an Auth0 account at https://auth0.com
# 2. Create a new Application (Single Page Application)
# 3. Configure the following in Auth0:
#    - Allowed Callback URLs: https://omni.example.com/oidc/callback
#    - Allowed Logout URLs: https://omni.example.com
#    - Allowed Web Origins: https://omni.example.com
# 4. Copy the Client ID and Domain from Auth0 dashboard
# 5. Update the AUTH variable above with your values

# =============================================================================
# Network Ports Reference
# =============================================================================
# The following ports must be accessible:
# - 443:   HTTPS web interface
# - 8090:  SideroLink API (machine communication)
# - 8100:  Kubernetes proxy
# - 50180: WireGuard (SideroLink VPN)
#
# Configure your firewall:
# sudo ufw allow 443/tcp
# sudo ufw allow 8090/tcp
# sudo ufw allow 8100/tcp
# sudo ufw allow 50180/udp
